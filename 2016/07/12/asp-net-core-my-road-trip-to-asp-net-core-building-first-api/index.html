<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/theme/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/theme/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/theme/favicon-16x16.png">
  <link rel="mask-icon" href="/images/theme/avatar.png" color="#222">
  <meta name="msvalidate.01" content="1CB8DB019C58E7852A318AAB16B1ABE5">
  <meta name="yandex-verification" content="92d8d8e521a054f7">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"huntertran.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":true,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Như vậy là các bạn đã bắt tay vào một project Asp.net core thật sự. Bài blog này sẽ hướng dẫn các bạn cách tự build một To-do list API đơn giản nhóe">
<meta property="og:type" content="article">
<meta property="og:title" content="[ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API">
<meta property="og:url" content="https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/">
<meta property="og:site_name" content="Hunter Tran&#39;s Blog">
<meta property="og:description" content="Như vậy là các bạn đã bắt tay vào một project Asp.net core thật sự. Bài blog này sẽ hướng dẫn các bạn cách tự build một To-do list API đơn giản nhóe">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://docs.microsoft.com/en-us/aspnet/core/mvc/overview/_static/mvc.png?view=aspnetcore-3.1">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7671/27642365454_2fb370b186_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7699/27976818140_4bfdcc1961_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7302/28153979252_5efe49a850_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7451/27976883070_1c07f475c2_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7704/28154355492_f4120179dd_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7654/27977529060_f3fe9e74aa_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/7416/27643155223_70a57c877b_o.png">
<meta property="article:published_time" content="2016-07-12T09:47:36.000Z">
<meta property="article:modified_time" content="2024-03-03T19:20:53.229Z">
<meta property="article:author" content="Hunter Tran">
<meta property="article:tag" content="programming, tech, computer tips, .net, c#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://docs.microsoft.com/en-us/aspnet/core/mvc/overview/_static/mvc.png?view=aspnetcore-3.1">


<link rel="canonical" href="https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/","path":"2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/","title":"[ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API | Hunter Tran's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174401878-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-174401878-1","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Hunter Tran's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hunter Tran's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Share to be shared</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-power-bi-reports"><a href="/power-bi-reports/" rel="section"><i class="fa fa-chart-simple fa-fw"></i>Power BI Reports</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Overview"><span class="nav-text">1. Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Tools"><span class="nav-text">2. Tools</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-Fiddler"><span class="nav-text">2.1. Fiddler</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-Google-Chrome"><span class="nav-text">2.2. Google Chrome</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Start"><span class="nav-text">3. Start</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Khoi-tao-Project"><span class="nav-text">3.1. Khởi tạo Project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Them-model"><span class="nav-text">3.2. Thêm model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-Them-Repository"><span class="nav-text">3.3. Thêm Repository</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-Register-cai-Repository"><span class="nav-text">3.4. Register cái Repository</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-Them-controller"><span class="nav-text">3.5. Thêm controller</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-Getting-to-do-items"><span class="nav-text">3.6. Getting to-do items</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Routing-va-URL-Paths"><span class="nav-text">4. Routing và URL Paths</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-Return-values"><span class="nav-text">5. Return values</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Trien-them-cac-phuong-thuc-CRUD-khac"><span class="nav-text">6. Triển thêm các phương thức CRUD khác</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-Create"><span class="nav-text">6.1. Create</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-Update"><span class="nav-text">6.2. Update</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-Delete"><span class="nav-text">6.3. Delete</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hunter Tran"
      src="/images/theme/avatar.png">
  <p class="site-author-name" itemprop="name">Hunter Tran</p>
  <div class="site-description" itemprop="description">Programming, technologies, computer tips and life thoughts</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">127</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">229</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/huntertran" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huntertran" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/huntertrantuan" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;huntertrantuan" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/4506315/tuan-tran" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;4506315&#x2F;tuan-tran" rel="noopener me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/theme/avatar.png">
      <meta itemprop="name" content="Hunter Tran">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hunter Tran's Blog">
      <meta itemprop="description" content="Programming, technologies, computer tips and life thoughts">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API | Hunter Tran's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API<a href="https://github.com/huntertran/blog/edit/master/source/_posts/20160712-asp-net-core-my-road-trip-to-asp-net-core-building-first-api.md" class="post-edit-link" title="Edit this post" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-07-12 05:47:36" itemprop="dateCreated datePublished" datetime="2016-07-12T05:47:36-04:00">2016-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-03 14:20:53" itemprop="dateModified" datetime="2024-03-03T14:20:53-05:00">2024-03-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CSharp/" itemprop="url" rel="index"><span itemprop="name">CSharp</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CSharp/ASP-NET/" itemprop="url" rel="index"><span itemprop="name">ASP.NET</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Như vậy là các bạn đã bắt tay vào một project Asp.net core thật sự. Bài blog này sẽ hướng dẫn các bạn cách tự build một To-do list API đơn giản nhóe</p>
<span id="more"></span>

<!-- TOC -->

<ul>
<li><a href="#1-overview">1. Overview</a></li>
<li><a href="#2-tools">2. Tools</a><ul>
<li><a href="#21-fiddler">2.1. Fiddler</a></li>
<li><a href="#22-google-chrome">2.2. Google Chrome</a></li>
</ul>
</li>
<li><a href="#3-start">3. Start</a><ul>
<li><a href="#31-kh%E1%BB%9Fi-t%E1%BA%A1o-project">3.1. Khởi tạo Project</a></li>
<li><a href="#32-th%C3%AAm-model">3.2. Thêm model</a></li>
<li><a href="#33-th%C3%AAm-repository">3.3. Thêm Repository</a></li>
<li><a href="#34-register-c%C3%A1i-repository">3.4. Register cái Repository</a></li>
<li><a href="#35-th%C3%AAm-controller">3.5. Thêm controller</a></li>
<li><a href="#36-getting-to-do-items">3.6. Getting to-do items</a></li>
</ul>
</li>
<li><a href="#4-routing-v%C3%A0-url-paths">4. Routing và URL Paths</a></li>
<li><a href="#5-return-values">5. Return values</a></li>
<li><a href="#6-tri%E1%BB%83n-th%C3%AAm-c%C3%A1c-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-crud-kh%C3%A1c">6. Triển thêm các phương thức CRUD khác</a><ul>
<li><a href="#61-create">6.1. Create</a></li>
<li><a href="#62-update">6.2. Update</a></li>
<li><a href="#63-delete">6.3. Delete</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p><a id="markdown-overview" name="overview"></a></p>
<p>Nếu bạn chưa biết API là gì</p>
<p>API là viết tắt của cụm từ Application Programming Interface, là một dạng giao diện cho phép bạn tương tác với một dữ liệu nào đó.</p>
<p>Ví dụ như Uber chả hạn, bật app Uber lên, bạn sẽ thấy có vài xe Uber đang đậu quanh bạn. Làm sao Uber biết chuyện này? Bằng cách gửi tọa độ GPS của bạn lên server, và server sẽ trả về vị trí các xe đang rảnh xung quanh bạn. App Uber sẽ gắn nó lên trên bản đồ.</p>
<p>Đây sẽ là các API mà chúng ta sẽ build</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Description</th>
<th>Request body</th>
<th>Response body</th>
</tr>
</thead>
<tbody><tr>
<td>GET &#x2F;api&#x2F;todo</td>
<td>Get all to-do items</td>
<td>None</td>
<td>Array of to-do items</td>
</tr>
<tr>
<td>GET &#x2F;api&#x2F;todo&#x2F;{id}</td>
<td>Get an item by ID</td>
<td>None</td>
<td>To-do item</td>
</tr>
<tr>
<td>POST &#x2F;api&#x2F;todo</td>
<td>Add a new item</td>
<td>To-do item</td>
<td>To-do item</td>
</tr>
<tr>
<td>PUT &#x2F;api&#x2F;todo&#x2F;{id}</td>
<td>Update an existing item</td>
<td>To-do item</td>
<td>None</td>
</tr>
<tr>
<td>DELETE &#x2F;api&#x2F;todo&#x2F;{id}</td>
<td>Delete an item.</td>
<td>None</td>
<td>None</td>
</tr>
</tbody></table>
<p>Sơ đồ</p>
<p><img src="https://docs.microsoft.com/en-us/aspnet/core/mvc/overview/_static/mvc.png?view=aspnetcore-3.1"></p>
<p>Chú thích</p>
<p>View: app &#x2F; web sẽ sử dụng API. Tạm thời chúng ta chưa quan tâm tới nó</p>
<p>Model: là kiểu dữ liệu của bạn. Trong ví dụ này, Model là To-do item</p>
<p>Controller: là thứ sẽ nhận HTTP Request, và tạo ra HTTP Responses. Ví dụ này sẽ chỉ có 1 controller duy nhất</p>
<p>Ví dụ này cũng không sử dụng Database, mà sẽ lưu trực tiếp trên bộ nhớ. Một API hoàn chỉnh sẽ có Database đi kèm nó</p>
<h1 id="2-Tools"><a href="#2-Tools" class="headerlink" title="2. Tools"></a>2. Tools</h1><p><a id="markdown-tools" name="tools"></a></p>
<p>Đễ dễ dàng debug, test API do mình tạo ra, bạn có thể sử dụng một số phần mềm</p>
<h2 id="2-1-Fiddler"><a href="#2-1-Fiddler" class="headerlink" title="2.1. Fiddler"></a>2.1. Fiddler</h2><p><a id="markdown-fiddler" name="fiddler"></a></p>
<p>Tải và cài đặt tại đây: <a target="_blank" rel="noopener" href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a></p>
<h2 id="2-2-Google-Chrome"><a href="#2-2-Google-Chrome" class="headerlink" title="2.2. Google Chrome"></a>2.2. Google Chrome</h2><p><a id="markdown-google-chrome" name="google-chrome"></a></p>
<p>Google Chrome thì khá tốt trong chuyện test tiếc các kiểu</p>
<h1 id="3-Start"><a href="#3-Start" class="headerlink" title="3. Start"></a>3. Start</h1><p><a id="markdown-start" name="start"></a></p>
<h2 id="3-1-Khoi-tao-Project"><a href="#3-1-Khoi-tao-Project" class="headerlink" title="3.1. Khởi tạo Project"></a>3.1. Khởi tạo Project</h2><p><a id="markdown-kh%E1%BB%9Fi-t%E1%BA%A1o-project" name="kh%E1%BB%9Fi-t%E1%BA%A1o-project"></a></p>
<p>Tạo mới 1 project, chọn template là ASP.NET Core Web Application (.NET Core), đặt tên là todoapi &gt; OK</p>
<p><img src="/images/flickr/7671/27642365454_2fb370b186_o.png"></p>
<p>Chọn template là Web API &gt; OK</p>
<p><img src="/images/flickr/7699/27976818140_4bfdcc1961_o.png"></p>
<h2 id="3-2-Them-model"><a href="#3-2-Them-model" class="headerlink" title="3.2. Thêm model"></a>3.2. Thêm model</h2><p><a id="markdown-th%C3%AAm-model" name="th%C3%AAm-model"></a></p>
<p>Model là một object đại diện cho dữ liệu của bạn trong ứng dụng. Trong ví dụ này thì model duy nhất chỉ là một to-do item thôi.</p>
<p>Tips: bạn nên đặt toàn bộ model trong một folder riêng, tương tự với view và controller (đã có sẵn folder cho controller)</p>
<p>Chuột phải vào Project &gt; Add &gt; New Folder</p>
<p><img src="/images/flickr/7302/28153979252_5efe49a850_o.png"></p>
<p>Tiếp tục chuột phải vào Folder Models &gt; Add &gt; Class, đặt tên class là TodoItem &gt; Ok</p>
<p><img src="/images/flickr/7451/27976883070_1c07f475c2_o.png"></p>
<p>Thêm 3 Property vô</p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="built_in">string</span> Key &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;
<span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;
<span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</code></pre>

<h2 id="3-3-Them-Repository"><a href="#3-3-Them-Repository" class="headerlink" title="3.3. Thêm Repository"></a>3.3. Thêm Repository</h2><p><a id="markdown-th%C3%AAm-repository" name="th%C3%AAm-repository"></a></p>
<p>Repository, tiếng Việt là một chỗ lưu trữ cái gì đó, là một kỹ thuật mới tinh beng của ASP.NET core. Theo như tài liệu của họ, thì Repository dùng để đóng gói data, và chứa logic cho việc truy cập dữ liệu và chuyển nó qua cho Entity Model.</p>
<p>Mặc dù app của chúng ta ko có database, nhưng mà cũng hay nếu như bạn hiểu cái đám code này hoạt động dư lào</p>
<p>Để bắt đầu, chúng ta sẽ tạo một repository interface có tên ITodoRepository, dùng cách thêm class như trên, nhưng chọn template là Interface nhóe</p>
<pre><code class="highlight csharp"><span class="keyword">namespace</span> <span class="title">todoapi.Models</span>
&#123;
    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ITodoRepository</span>
    &#123;
        <span class="function"><span class="keyword">void</span> <span class="title">Add</span>(<span class="params">TodoItem item</span>)</span>;
        <span class="function">IEnumerable&lt;TodoItem&gt; <span class="title">GetAll</span>()</span>;
        <span class="function">TodoItem <span class="title">Find</span>(<span class="params"><span class="built_in">string</span> key</span>)</span>;
        <span class="function">TodoItem <span class="title">Remove</span>(<span class="params"><span class="built_in">string</span> key</span>)</span>;
        <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params">TodoItem item</span>)</span>;
    &#125;
&#125;</code></pre>

<p>Cái interface này định nghĩa các phương thức CRUD (Create - Read – Update – Delete)</p>
<p>Tiếp theo, ta thêm class TodoRepository, triển khai các phương thức trong Interface mới tạo bên trên</p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoRepository</span> : <span class="title">ITodoRepository</span>
&#123;
    <span class="keyword">private</span> <span class="keyword">static</span> ConcurrentDictionary&lt;<span class="built_in">string</span>, TodoItem&gt; _todos = <span class="keyword">new</span> ConcurrentDictionary&lt;<span class="built_in">string</span>, TodoItem&gt;();
    <span class="function"><span class="keyword">public</span> <span class="title">TodoRepository</span>()</span>
    &#123;
        Add(<span class="keyword">new</span> TodoItem &#123; Name = <span class="string">&quot;Item1&quot;</span> &#125;);
    &#125;
 
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Add</span>(<span class="params">TodoItem item</span>)</span>
    &#123;
        item.Key = Guid.NewGuid().ToString();
        _todos[item.Key] = item;
    &#125;
 
    <span class="function"><span class="keyword">public</span> IEnumerable&lt;TodoItem&gt; <span class="title">GetAll</span>()</span>
    &#123;
        <span class="keyword">return</span> _todos.Values;
    &#125;
 
    <span class="function"><span class="keyword">public</span> TodoItem <span class="title">Find</span>(<span class="params"><span class="built_in">string</span> key</span>)</span>
    &#123;
        TodoItem item;
        _todos.TryGetValue(key, <span class="keyword">out</span> item);
        <span class="keyword">return</span> item;
    &#125;
 
    <span class="function"><span class="keyword">public</span> TodoItem <span class="title">Remove</span>(<span class="params"><span class="built_in">string</span> key</span>)</span>
    &#123;
        TodoItem item;
        _todos.TryGetValue(key, <span class="keyword">out</span> item);
        _todos.TryRemove(key, <span class="keyword">out</span> item);
        <span class="keyword">return</span> item;
    &#125;
 
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params">TodoItem item</span>)</span>
    &#123;
        _todos[item.Key] = item;
    &#125;
&#125;</code></pre>

<p>Xong xuôi thì build nó phát để coi có lỗi gì hok</p>
<p><img src="/images/flickr/7704/28154355492_f4120179dd_o.png"></p>
<p>Build xong nó lên dư lày là okie</p>
<p><img src="/images/flickr/7654/27977529060_f3fe9e74aa_o.png"></p>
<h2 id="3-4-Register-cai-Repository"><a href="#3-4-Register-cai-Repository" class="headerlink" title="3.4. Register cái Repository"></a>3.4. Register cái Repository</h2><p><a id="markdown-register-c%C3%A1i-repository" name="register-c%C3%A1i-repository"></a></p>
<p>Bằng cách khai báo Interface repository, ta có thể tách biệt class repository ra khỏi controller xài nó. Thay vì tạo ra một instance của TodoRepository trong controller, ta có thể chọt cái ITodoRepository vào thẳng ASP.NET để sau này xài Depenency Injection (chưa biết nó là gì, tài liệu ở đây: <a target="_blank" rel="noopener" href="https://docs.asp.net/en/latest/fundamentals/dependency-injection.html">https://docs.asp.net/en/latest/fundamentals/dependency-injection.html</a>)</p>
<p>Cách này giúp bạn dễ dàng viết Unit Test hơn. Test sẽ thu hẹp lại xuống logic của controller, chứ không test cái truy xuất dữ liệu.</p>
<p>Để chọt (inject) nó vô controller, ta cần đăng ký nó. Mở file Startup.cs, thêm dòng sau vô đầu</p>
<pre><code class="highlight csharp"><span class="keyword">using</span> todoapi.Models;</code></pre>

<p>Trong phương thức configureServices, thêm đoạn code sau vô cuối</p>
<pre><code class="highlight csharp"><span class="comment">//Add our repository type</span>
services.AddSingleton&lt;ITodoRepository, TodoRepository&gt;();</code></pre>

<h2 id="3-5-Them-controller"><a href="#3-5-Them-controller" class="headerlink" title="3.5. Thêm controller"></a>3.5. Thêm controller</h2><p><a id="markdown-th%C3%AAm-controller" name="th%C3%AAm-controller"></a></p>
<p>Chuột phải lên thư mục Controller &gt; Add &gt; New Item</p>
<p>Chọn Web API Controller Class, đặt tên TodoController</p>
<p><img src="/images/flickr/7416/27643155223_70a57c877b_o.png"></p>
<p>Xóa hết code trong class đi, thay bằng cái lày</p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoController</span> : <span class="title">Controller</span>
&#123;
    <span class="keyword">public</span> ITodoRepository TodoItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;
 
    <span class="function"><span class="keyword">public</span> <span class="title">TodoController</span>(<span class="params">ITodoRepository todoItems</span>)</span>
    &#123;
        TodoItems = todoItems;
    &#125;
&#125;</code></pre>

<p>Như vậy là bạn đã khai báo một cái controller chả có gì bên trong cả. Trong các phần tiếp theo, chúng ta sẽ thêm các method để triển khai API nhóe.</p>
<h2 id="3-6-Getting-to-do-items"><a href="#3-6-Getting-to-do-items" class="headerlink" title="3.6. Getting to-do items"></a>3.6. Getting to-do items</h2><p><a id="markdown-getting-to-do-items" name="getting-to-do-items"></a></p>
<p>Thêm method sau vào TodoController</p>
<pre><code class="highlight csharp"><span class="function"><span class="keyword">public</span> IEnumerable&lt;TodoItem&gt; <span class="title">GetAll</span>()</span>
&#123;
    <span class="keyword">return</span> TodoItems.GetAll();
&#125;
 
[<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>, Name = <span class="string">&quot;GetToDo&quot;</span>)</span>]
<span class="function"><span class="keyword">public</span> IActionResult <span class="title">GetById</span>(<span class="params"><span class="built_in">string</span> id</span>)</span>
&#123;
    <span class="keyword">var</span> item = TodoItems.Find(id);
    <span class="keyword">if</span> (item == <span class="literal">null</span>)
    &#123;
        <span class="keyword">return</span> NotFound();
    &#125;
    <span class="keyword">return</span> <span class="keyword">new</span> ObjectResult(item);
&#125;</code></pre>

<p>Phương thức này có 2 cái get</p>
<ul>
<li>GET &#x2F;api&#x2F;todo</li>
<li>GET &#x2F;api&#x2F;todo&#x2F;{id}</li>
</ul>
<p>Sau đây là một ví dụ cho HTTP Response khi gọi phương thức GetAll</p>
<blockquote>
<p>HTTP&#x2F;1.1 200 OK Content-Type: application&#x2F;json; charset&#x3D;utf-8 Server: Microsoft-IIS&#x2F;10.0 Date: Thu, 18 Jun 2015 20:51:10 GMT Content-Length: 82</p>
<p>[{“Key”:”4f67d7c5-a2a9-4aae-b030-16003dd829ae”,”Name”:”Item1”,”IsComplete”:false}]</p>
</blockquote>
<p>Sau này chúng ta sẽ dùng Fiddler để test các phương thức này nhóe</p>
<h1 id="4-Routing-va-URL-Paths"><a href="#4-Routing-va-URL-Paths" class="headerlink" title="4. Routing và URL Paths"></a>4. Routing và URL Paths</h1><p><a id="markdown-routing-v%C3%A0-url-paths" name="routing-v%C3%A0-url-paths"></a></p>
<p>Trong cái phương thức trên, bạn sẽ thấy có [HttpGet]. Cái này gọi là Attribute, và Attribute này dùng để chỉ định phương thức cho method bên dưới là Get. Đường dẫn Url thì được xây dựng như sau</p>
<ul>
<li>Lấy cái string trong Controller’s Route: [Route(“api&#x2F;[controller]”)]</li>
<li>Bỏ cái [controller] ra, thay bằng tên của cái controller (tất nhiên là trừ đi chữ “Controller” nhóe). Ví dụ TodoController thì sẽ thay cái chữ Todo vô thôi</li>
<li>Nếu mà HttpGet có template string, thì thêm cái string đó vô path. Cái ví dụ trên thì ko có</li>
</ul>
<p>Trong cái phương thức GetId bên trên, “{id}” là một giá trị giữ chỗ. Khi request lên, client sẽ xài cái Id của TodoItem thế vô đó.</p>
<h1 id="5-Return-values"><a href="#5-Return-values" class="headerlink" title="5. Return values"></a>5. Return values</h1><p><a id="markdown-return-values" name="return-values"></a></p>
<p>Phương thức GetAll trả về một kiểu dữ liệu là CLR Object. MVC tự động đổi nó thành JSON và viết JSON ra cái body của cái Reponse message. Reponse code sẽ là 200. Nếu có unhandled exception, reponse code sẽ là 5xx</p>
<ul>
<li>Nếu không có item nào có Id như răng, trả về reponse code 404. Cái này được định nghĩa bằng phương thức NotFound()</li>
</ul>
<h1 id="6-Trien-them-cac-phuong-thuc-CRUD-khac"><a href="#6-Trien-them-cac-phuong-thuc-CRUD-khac" class="headerlink" title="6. Triển thêm các phương thức CRUD khác"></a>6. Triển thêm các phương thức CRUD khác</h1><p><a id="markdown-tri%E1%BB%83n-th%C3%AAm-c%C3%A1c-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-crud-kh%C3%A1c" name="tri%E1%BB%83n-th%C3%AAm-c%C3%A1c-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-crud-kh%C3%A1c"></a></p>
<h2 id="6-1-Create"><a href="#6-1-Create" class="headerlink" title="6.1. Create"></a>6.1. Create</h2><p><a id="markdown-create" name="create"></a></p>
<pre><code class="highlight csharp">[<span class="meta">HttpPost</span>]
<span class="function"><span class="keyword">public</span> IActionResult <span class="title">Create</span>(<span class="params">[FromBody] TodoItem item</span>)</span>
&#123;
    <span class="keyword">if</span> (item == <span class="literal">null</span>)
    &#123;
        <span class="keyword">return</span> BadRequest();
    &#125;
    TodoItems.Add(item);
    <span class="keyword">return</span> CreatedAtRoute(<span class="string">&quot;GetTodo&quot;</span>, <span class="keyword">new</span> &#123;id = item.Key&#125;, item);
&#125;</code></pre>

<p>Phương thức Post</p>
<p>[FromBody] cho phép MVC biết là cái TodoItem đó lấy từ body của request message</p>
<p>Return CreatedAtRoute: sẽ trả về địa chỉ của cái item đấy luôn</p>
<h2 id="6-2-Update"><a href="#6-2-Update" class="headerlink" title="6.2. Update"></a>6.2. Update</h2><p><a id="markdown-update" name="update"></a></p>
<pre><code class="highlight csharp">[<span class="meta">HttpPut(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]
<span class="function"><span class="keyword">public</span> IActionResult <span class="title">Update</span>(<span class="params"><span class="built_in">string</span> id, [FromBody] TodoItem item</span>)</span> 
&#123;
    <span class="keyword">if</span> (item == <span class="literal">null</span> || item.Key != id) 
    &#123;
        <span class="keyword">return</span> BadRequest();
    &#125;
 
    <span class="keyword">var</span> todo = TodoItems.Find(id);
    <span class="keyword">if</span> (todo == <span class="literal">null</span>) 
    &#123;
        <span class="keyword">return</span> NotFound();
    &#125;
    TodoItems.Update(item);
    <span class="keyword">return</span> <span class="keyword">new</span> NoContentResult();
&#125;</code></pre>

<p>Update cũng giống giống Create, nhưng mà xài HttpPut. Response chuẩn là 204 (No Content)</p>
<p>Theo như tài liệu của HTTP, thì Put request đòi hỏi client phải gửi toàn bộ nội dung của item cần update, chứ không phải vài thông tin rời rạc. Để update chỉ 1 thông tin nào đó, dùng HttpPatch</p>
<h2 id="6-3-Delete"><a href="#6-3-Delete" class="headerlink" title="6.3. Delete"></a>6.3. Delete</h2><p><a id="markdown-delete" name="delete"></a></p>
<pre><code class="highlight csharp">[<span class="meta">HttpDelete(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]
<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params"><span class="built_in">string</span> id</span>)</span>
&#123;
    TodoItems.Remove(id);
&#125;</code></pre>

<p>Void trả về response là 204 (No Content). Tức là client sẽ nhận được 204 kể cả khi Item đã bị delete hay item ko tồn tại</p>
<p>Vậy là xong rồi, chờ bài post tiếp theo nhóe bạn</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/theme/paypal.png" alt="Hunter Tran PayPal">
        <span>PayPal</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Hunter Tran
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/" title="[ASP.NET CORE] – My Road trip to ASP.NET Core – Building first API">https://huntertran.github.io/blog/2016/07/12/asp-net-core-my-road-trip-to-asp-net-core-building-first-api/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/huntertrantuan">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2016/07/11/c-string-performance-tips-and-tricks/" rel="prev" title="C# string performance – Tips and Tricks">
                  <i class="fa fa-angle-left"></i> C# string performance – Tips and Tricks
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/01/04/asp-net-tips-and-tricks-using-prompt-attribute-as-placeholder-for-mvc5/" rel="next" title="[ASP.NET Tips and Tricks] Using Prompt Attribute as Placeholder for MVC5">
                  [ASP.NET Tips and Tricks] Using Prompt Attribute as Placeholder for MVC5 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-disqus">disqus</a></li>
            <li class="tab"><a href="#comment-utterances">utterances</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane disqus" id="comment-disqus">
              
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
            </div>
            <div class="tab-pane utterances" id="comment-utterances">
              <div class="comments utterances-container"></div>
            </div>
        </div>
      </div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2011 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Hunter Tran</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" integrity="sha256-4mJNT2bMXxcc1GCJaxBmMPdmah5ji0Ldnd79DKd1hoM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha256-9cmf7tcLdXpKsPi/2AWE93PbZpTp4M4tqzFk+lWomjU=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"huntertran-blog","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"huntertran/huntertran-blog-comments","issue_term":"pathname","theme":"github-dark"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
