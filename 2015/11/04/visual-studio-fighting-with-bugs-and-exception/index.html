<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>[Visual Studio] Fighting with Bugs and Exceptions | Tuan Tran's Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/blog/atom.xml" title="Tuan Tran's Blog" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/blog/plugins/prettify/doxy.css"><script type="text/javascript" src="/blog/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">Tuan Tran's Blog</a></h1></div><p class="m-desc">Share to be shared</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/blog/archives/">Archives</a></li><li><span class="dot">●</span><a href="/blog/categories/">Categories</a></li><li><span class="dot">●</span><a href="/blog/tags/">Tags</a></li><li><span class="dot">●</span><a href="/blog/about/">About</a></li><li><span class="dot">●</span><a href="/blog/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="Search for" onfocus="if(this.value=='Search for'){this.value='';}" onblur="if(this.value==''){this.value='Search for';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">[Visual Studio] Fighting with Bugs and Exceptions</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/blog/2015/11/04/visual-studio-fighting-with-bugs-and-exception/">2015-11-04</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/blog/categories/uncategorized/">uncategorized</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><p>Lập trình bằng Visual Studio, tới một thời điểm nào đó ai cũng sẽ gặp bug và Exception. Đối với một số exception, Visual Studio sẽ bôi vàng đoạn code gây ra exception, nhưng đối với một số exception khác, Visual Studio lại nhảy hẳn ra ngoài. Vì sao vậy? Tại sao không cho tôi biết code chỗ nào bị lỗi.</p>
<p>Visual Studio 2015 có một cải tiến đáng giá giúp lập trình viên biết chính xác chỗ code nào bị exception, và một số cải tiến vô cùng đáng giá khác khi debug một đoạn code</p>
<a id="more"></a>
<h1 id="Advanced-Debugging"><a href="#Advanced-Debugging" class="headerlink" title="Advanced Debugging"></a>Advanced Debugging</h1><p>Tất cả mọi người đều biết, để debug một đoạn code, bạn thường đặt một break point. Khi code chạy tới đó, nó sẽ dừng ngay tại Breakpoint đó. The end. Hết phim. Tuy nhiên, nếu bạn đọc bài blog này: <a target="_blank" rel="noopener" href="https://cuoilennaocacban2.wordpress.com/2015/10/22/visual-studio-performance-performance-performance-with-the-help-of-visual-studio-perftips/">[Visual Studio] Performance, performance, performance (with the help of Visual Studio “PerfTips”)</a>, bạn sẽ thấy một công dụng nữa của Breakpoint dành cho việc đo đạc thời gian chạy một đoạn code. Ngoài ra, Breakpoint còn có một số công dụng khác nữa</p>
<h2 id="Output-Log-with-Breakpoint"><a href="#Output-Log-with-Breakpoint" class="headerlink" title="Output Log with Breakpoint"></a>Output Log with Breakpoint</h2><p><img src="https://farm6.staticflickr.com/5628/22152610574_b5e8c867c4_o.png"></p>
<p>Trong vòng lặp trên, bạn sẽ thấy có dòng “Debug.WriteLine” dùng để xuất một thông tin gì đó ra màn hình Output. Thông tin này sẽ giúp bạn biết code đã chạy tới dòng này, và xuất ra các giá trị mà bạn mong muốn.</p>
<p><img src="https://farm1.staticflickr.com/618/22152668514_87a33835e7_o.png"></p>
<p>Từ giờ, bạn không cần phải làm thủ công như vậy nữa.</p>
<p>Đưa chuột lại gần Breakpoint, một menu nhỏ xíu hiện ra, nhấn vào dấu răng cưa</p>
<p><img src="https://farm1.staticflickr.com/706/22775443405_64dfbcf543_o.png"></p>
<p>Một cái cửa sổ hiện ra, chèn vào giữa đoạn code đặt breakpoint của bạn. Tick chọn ô Action. Bạn sẽ thấy tính năng “Log a message to output Windows”</p>
<p><img src="https://farm6.staticflickr.com/5649/22761956172_d042077119_o.png"></p>
<p>Gõ vào trong ô đó những thứ bạn muốn xuất ra cửa sổ output. Biến thì để trong dấu ngoặc nhọn. Thế là xong</p>
<p><img src="https://farm6.staticflickr.com/5813/22154779113_ab9acf18e1_o.png"></p>
<p>Khi chạy lại app, cửa sổ output sẽ là</p>
<p><img src="https://farm6.staticflickr.com/5803/22762522502_765d5041fe_o.png"></p>
<p>Bạn thấy con số nằm trong ngoặc kép là vì nó là kiểu string, không phải int. Nên khi hiển thị, Visual Studio sẽ đưa nó vào trong ngoặc kép</p>
<p>Bây giờ, hãy so sánh một chút</p>
<p><strong>Breakpoint “Action”</strong></p>
<p><strong>Debug.WriteLine()</strong></p>
<p><strong>Lợi</strong></p>
<p>Nhanh chóng, đơn giản</p>
<p>Không thay đổi code</p>
<p>Có thể chỉnh sửa khi ứng dụng đang chạy</p>
<p>Có thể kết hợp với Condition của Breakpoint</p>
<p>Có thể quản lý tập trung trong cửa sổ Debug</p>
<p>Sử dụng linh hoạt</p>
<p>Trực quan, dễ hiểu</p>
<p>Có thể chèn nhiều dòng</p>
<p><strong>Bất lợi</strong></p>
<p>Chỉ xuất ra được 1 dòng (mình chưa tìm được cách xuống dòng)</p>
<p>Phải thay đổi code</p>
<p>Không thể chỉnh sửa khi app đang chạy</p>
<p>Dùng Debug.WriteLineIf() để thêm điều kiện</p>
<p>Muốn tìm phải dùng Ctrl + F để tìm kiếm phrase như thông thường</p>
<p>Giảm hiệu suất (không đáng kể, và không ảnh hưởng khi Release)</p>
<p>Như vậy sử dụng cái nào hoàn toàn là quyền của bạn</p>
<h2 id="Condition-Breakpoint"><a href="#Condition-Breakpoint" class="headerlink" title="Condition Breakpoint"></a>Condition Breakpoint</h2><p>Tiếp tục tick chọn ô Condition, cửa sổ được mở rộng ra để lộ nhiều tùy chọn hơn cho bạn</p>
<p><img src="https://farm1.staticflickr.com/757/22588283440_b481c716fc_o.png"></p>
<p>Bạn có nhiều tùy chọn để quyết định xem là Visual Studio có dừng lại ở Breakpoint này hay không. Trong số đó có</p>
<ul>
<li><p>Conditional Expression: Biểu thức điều kiện: Sẽ dừng ở breakpoint khi điều kiện đúng</p>
</li>
<li><p>Hit Count: Số lần chạy qua: Cứ mỗi lần chạy qua breakpint này, Visual Studio sẽ tính là một hit. Khi đạt tới số lượng hit nhất định do bạn đặt thì sẽ dừng.</p>
</li>
<li><p>Filter: Sẽ dừng ở Breakpoint khi một số điều kiện đặc biệt được thỏa mãn (ví dụ như MachineName, ProcessId, vân vân)</p>
</li>
</ul>
<p>Đối với App Windows, bạn sẽ cần dùng 2 cái đầu tiên nhiều nhất</p>
<p>Giả sử mình muốn dừng lại ở lần chạy thứ 9, và xuất ra màn hình biến ở lần chạy này, thì thiết lập như sau:</p>
<p><img src="https://farm6.staticflickr.com/5675/22787742791_38aeba8663_o.png"></p>
<h1 id="The-new-Exception-Settings"><a href="#The-new-Exception-Settings" class="headerlink" title="The new Exception Settings"></a>The new Exception Settings</h1><p>Đã bao giờ bạn gặp phải cái lỗi ở cái dòng lạ hoắc như vầy chưa?</p>
<p><img src="https://farm1.staticflickr.com/778/22155676943_b38eeef94c_o.png"></p>
<p>DISABLE_XAML_BREAK_ON_UNHANDLED_EXCEPTION</p>
<p>Global::System.Diagnostics.Debugger.Break();</p>
<p>Cái này là gì</p>
<p>Hoặc lỗi như vầy</p>
<p><img src="https://farm6.staticflickr.com/5810/22776832185_80b555ab2f_o.png"></p>
<p>“An exception of type “Blah blah blah” occurred in Yourappname.exe but was not handled in user code”, và kèm theo đó là Visual Studio dừng ở một dòng lạ hoắc, và bạn biết chắc chắn là lỗi xảy ra ở chỗ khác, không phải dòng này.</p>
<p>Đó là lý do ta sẽ dùng Exception Setting để nhảy tới đúng chỗ code sinh ra lỗi</p>
<p>Bạn vào Debug &gt; Windows &gt; Exception Settings…</p>
<p><img src="https://farm1.staticflickr.com/750/22788116721_a7e75bc800_o.png"></p>
<p>Copy tên của Exception, trong trường hợp trên là “System.Exception” và paste nó vào ô tìm kiếm. Tíck chọn kết quả hiện ra</p>
<p><img src="https://farm1.staticflickr.com/592/22588970370_394a956f21_o.png"></p>
<p>Chạy lại app. Và bây giờ, Visual Studio sẽ nhảy tới đúng dòng bị lỗi</p>
<p><img src="https://farm6.staticflickr.com/5829/22763429822_fe3f21d523_o.png"></p>
<p>Quá tuyệt, phải không</p>
<p>Đón xem các bài blog tiếp theo về các tính năng cực kute của Visual Studio nhé.</p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">Author：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Tuan Tran</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">Link to this article：</span><span class="p-copytight-value"><a href="/blog/2015/11/04/visual-studio-fighting-with-bugs-and-exception/">https://huntertran.github.io/blog/2015/11/04/visual-studio-fighting-with-bugs-and-exception/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">Copyright：</span><span class="p-copytight-value">All rights reserved with<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>agreement. Include the source <a href="https://huntertran.github.io/blog">Tuan Tran's blog</a>！</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tags"></i><a href="/blog/tags/Visual-Studio/">Visual Studio</a><a href="/blog/tags/advanced/">advanced</a><a href="/blog/tags/bugs/">bugs</a><a href="/blog/tags/exception/">exception</a></span></div><aside id="toc"><div class="toc-title">Table of Contents</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Advanced-Debugging"><span class="toc-number">1.</span> <span class="toc-text">Advanced Debugging</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Output-Log-with-Breakpoint"><span class="toc-number">1.1.</span> <span class="toc-text">Output Log with Breakpoint</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Condition-Breakpoint"><span class="toc-number">1.2.</span> <span class="toc-text">Condition Breakpoint</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-new-Exception-Settings"><span class="toc-number">2.</span> <span class="toc-text">The new Exception Settings</span></a></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/blog/2015/11/13/3b32afebb58ae7f1f05a25abbe5a3552/">&lt; Nguyễn Ngọc Tiến - 2015-11-13 15:03:02</a><a class="next" href="/blog/2015/10/26/uwp-create-image-assets-for-your-apps/">[UWP] Create image assets for your apps &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  lang: 'en',
  placeholder:'ヾﾉ≧∀≦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright © 2016 - 2020 <a href="/blog/." rel="nofollow">Tuan Tran's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/blog/plugins/prettify/prettify.js"></script><script type="text/javascript" src="/blog/js/search.js"></script><script type="text/javascript" src="/blog/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.1" async></script></body></html>