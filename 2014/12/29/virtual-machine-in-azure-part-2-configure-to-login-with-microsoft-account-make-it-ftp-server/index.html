<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>Virtual Machine in Azure Part 2: Configure to login with Microsoft Account &amp; make it FTP Server | Tuan Tran's Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/blog/atom.xml" title="Tuan Tran's Blog" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/blog/plugins/prettify/doxy.css"><script type="text/javascript" src="/blog/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">Tuan Tran's Blog</a></h1></div><p class="m-desc">Share to be shared</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/blog/archives/">Archives</a></li><li><span class="dot">●</span><a href="/blog/categories/">Categories</a></li><li><span class="dot">●</span><a href="/blog/tags/">Tags</a></li><li><span class="dot">●</span><a href="/blog/about/">About</a></li><li><span class="dot">●</span><a href="/blog/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="Search for" onfocus="if(this.value=='Search for'){this.value='';}" onblur="if(this.value==''){this.value='Search for';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">Virtual Machine in Azure Part 2: Configure to login with Microsoft Account &amp; make it FTP Server</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/blog/2014/12/29/virtual-machine-in-azure-part-2-configure-to-login-with-microsoft-account-make-it-ftp-server/">2014-12-29</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/blog/categories/Azure/">Azure</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><p>Chào các bạn, ở phần trước, các bạn đã biết cách tạo một Virtual Machine trên Azure. Phần này mình sẽ hướng dẫn cho các bạn cách thiết lập nó để đăng nhập bằng chính Microsoft Account của bạn, và biến nó thành một máy chủ FTP nhé.</p>
<a id="more"></a>
<h1 id="Login-with-MS-Account"><a href="#Login-with-MS-Account" class="headerlink" title="Login with MS Account"></a>Login with MS Account</h1><p>Tạo một user mới, dùng Microsoft Account làm username (ví dụ như <a href="mailto:blahblahblah@hotmail.com">blahblahblah@hotmail.com</a> chả hạn)</p>
<p><img src="https://farm8.staticflickr.com/7480/16133514591_b1627eeae8_o.png"></p>
<p><img src="https://farm8.staticflickr.com/7553/16135418725_c4193f946f_o.png"></p>
<p>Sau khi tạo xong, mở Computer Management, chọn mục Local Users and Groups trong System Tools. User mới tạo sẽ xuất hiện trong mục này với một cái tên bị cắt ngắn.</p>
<p>Bạn mở Property của User này lên, chuyển sang thẻ Member of, thêm người này vào nhóm Remote Desktop Users.</p>
<p><img src="https://farm8.staticflickr.com/7473/16134669652_56a4064c9b_o.png"></p>
<p><img src="https://farm8.staticflickr.com/7494/16109629516_1bbd681b2b_o.png"></p>
<p>Trong Control Panel, mở System and Security, chọt Allow Remote Access, bỏ chọn tùy chọn “Allow connections only … with Network Level Authentication”.</p>
<p><img src="https://farm8.staticflickr.com/7550/16134669472_0ca0f6cf48_o.png"></p>
<p>Bước cuối cùng là mở file .RDP lên bằng notepad, thay đổi dòng “<strong>prompt for credentials:i:1</strong>” thành “<strong>enablecredsspsupport:i:0</strong>”</p>
<p>Vậy là xong. Sau khi đăng nhập lần đầu tiên, bạn có thể undo 2 bước cuối cùng.</p>
<h1 id="FTP-Server"><a href="#FTP-Server" class="headerlink" title="FTP Server"></a>FTP Server</h1><h2 id="Cai-dat-tren-Azure-Portal"><a href="#Cai-dat-tren-Azure-Portal" class="headerlink" title="Cài đặt trên Azure Portal"></a>Cài đặt trên Azure Portal</h2><p>Bước đầu tiên, bạn phải tạo một port 21 trong phần quản lý của Azure</p>
<p>Click chọn Add trong phần Endpoint của Virtual Machine của bạn</p>
<p><img src="https://farm8.staticflickr.com/7555/15949429589_b3ec1b188f_o.png"></p>
<p>Chọn Add a stand alone endpoint và nhấn next</p>
<p><img src="https://farm8.staticflickr.com/7544/16133612571_e8534a1023_o.png"></p>
<p>Chọn FTP, các thông số sẽ tự điền vô cho bạn (:yay:)</p>
<p><img src="https://farm8.staticflickr.com/7520/15949443029_fc25fc17d1_o.png"></p>
<p>Chờ nó hoàn tất</p>
<p><img src="https://farm8.staticflickr.com/7568/15949450879_d152283f57_o.png"></p>
<h2 id="Cai-dat-tren-Virtual-Machine"><a href="#Cai-dat-tren-Virtual-Machine" class="headerlink" title="Cài đặt trên Virtual Machine"></a>Cài đặt trên Virtual Machine</h2><h3 id="Cai-FileZilla-Server"><a href="#Cai-FileZilla-Server" class="headerlink" title="Cài FileZilla Server"></a>Cài FileZilla Server</h3><p>Trên VM, bạn tải FileZilla Server về: <a target="_blank" rel="noopener" href="https://filezilla-project.org/download.php?type=server">https://filezilla-project.org/download.php?type=server</a></p>
<p>Khi cài đặt, chấp nhận tất cả các tùy chọn mặc định của nó</p>
<p>Mở FileZilla Server lên, chọn Edit &gt; Users</p>
<p><img src="https://farm8.staticflickr.com/7558/15948351778_1d23368c73_o.png"></p>
<p>Thêm một User mới với tên tùy chọn. Đây là tên bạn sẽ dùng để đăng nhập vào FTP Server của mình sau này</p>
<p><img src="https://farm8.staticflickr.com/7509/15948353428_0c2804bfc0_o.png"> <img src="https://farm9.staticflickr.com/8655/16110010396_2ff5e90b5b_o.png"></p>
<p>Thêm password cho tài khoản này. Nếu không thì Man-in-the-middle sẽ truy cập được và server của bạn và tiến hành phá hoại</p>
<p><img src="https://farm8.staticflickr.com/7547/16135806475_92b2f1c975_o.png"></p>
<p>Tiếp theo, chọn Shared Folders và thêm vào Folder mà bạn sẽ kết nối để download hoặc upload dữ liệu</p>
<p><img src="https://farm9.staticflickr.com/8579/16134067331_1317d1baa7_o.png"></p>
<p>Lưu ý rằng có các tùy chọn cho phép các quyền khác nhau đối với folder, và các quyền này đi theo tài khoản mà bạn đã tạo và đã chọn trong FileZilla Server</p>
<p>Lưu ý 2: Không được chọn Folder gốc (C:/ D:/ E:/), luôn luôn chọn Folder dưới mức gốc 1 level</p>
<p>Tiếp tục, mở FileZilla Server Settings, chọn Passive Mode</p>
<p><img src="https://farm8.staticflickr.com/7553/16110037406_9a3392ff54_o.png"></p>
<p>Chọn “Use custom Port Range, và điền một số port cho cả 2 bên (vì bạn sẽ ko muốn tạo ra cả trăm port trên Azure Portal đâu)</p>
<p>Tiếp tục chọn Retrieve external IP Address from</p>
<p><img src="https://farm8.staticflickr.com/7529/16110190066_890fb9766c_o.png"></p>
<h3 id="Thiep-lap-Firewall"><a href="#Thiep-lap-Firewall" class="headerlink" title="Thiếp lập Firewall"></a>Thiếp lập Firewall</h3><p>Mở Windows Firewall lên và cho phép FileZilla Server</p>
<p>Chọn Allow an app through Windows Filewall</p>
<p><img src="https://farm8.staticflickr.com/7517/15950078947_c6588c56ac_o.png"></p>
<p>Nếu bạn không tìm thấy FileZilla Server trong danh sách, thì duyệt tới file thực thi .exe của nó</p>
<p><img src="https://farm8.staticflickr.com/7495/16135094662_38e4a8b7ab_o.png"></p>
<p>Sau cùng nó phải giống như vầy</p>
<p><img src="https://farm9.staticflickr.com/8675/15516120053_03bd077f97_o.png"></p>
<p>Tiếp theo, ở Control Panel &gt; Windows Firewall, chọn Advanced Settings</p>
<p><img src="https://farm9.staticflickr.com/8644/16133948991_6f9fb96a8d_o.png"></p>
<p>Chọn Inbound Rules, và thêm cái custom Port của bạn hồi nãy mới thiếp lập trong FileZilla Server</p>
<p><img src="https://farm8.staticflickr.com/7570/15513526614_76337d6844_o.png"> <img src="https://farm9.staticflickr.com/8638/16110072306_90f3ffacf3_o.png"> <img src="https://farm8.staticflickr.com/7462/16135112792_25b507d9d3_o.png"></p>
<p>Thiết lập cổng cho cái Inbound Rule này</p>
<p><img src="https://farm8.staticflickr.com/7485/15513532304_2608708f49_o.png"></p>
<h2 id="Cai-dat-tren-Local-Machine"><a href="#Cai-dat-tren-Local-Machine" class="headerlink" title=" Cài đặt trên Local Machine"></a> Cài đặt trên Local Machine</h2><h3 id="Cai-dat-FileZilla-Client"><a href="#Cai-dat-FileZilla-Client" class="headerlink" title="Cài đặt FileZilla Client"></a>Cài đặt FileZilla Client</h3><p>Tải FileZilla Client tại: <a target="_blank" rel="noopener" href="https://filezilla-project.org/download.php?type=client">https://filezilla-project.org/download.php?type=client</a></p>
<p>Khi khởi chạy, điền dải IP trong Public IP trên Azure của bạn</p>
<p><img src="https://farm8.staticflickr.com/7569/16135891365_c631a0fc94_o.png"></p>
<p>Điền các thông tin vào các ô tương ứng và nhấn quick connect</p>
<p><img src="https://farm9.staticflickr.com/8657/16134040481_9840ea9497_o.png"></p>
<p>Danh sách các Folder bạn đã Share sẽ hiện ra :3</p>
<p><img src="https://farm9.staticflickr.com/8667/15949873649_5254d44ec9_o.png"></p>
<h2 id="Thu-nghiem-toc-do-cua-FTP-Server-moi-tao"><a href="#Thu-nghiem-toc-do-cua-FTP-Server-moi-tao" class="headerlink" title="Thử nghiệm tốc độ của FTP Server mới tạo"></a>Thử nghiệm tốc độ của FTP Server mới tạo</h2><p>Tốc độ mạng của Azure</p>
<p><img src="http://www.speedtest.net/result/4018401482.png"></p>
<p>Download</p>
<p><img src="https://farm8.staticflickr.com/7556/15948706180_d594463823_o.png"></p>
<p>Mạng công ty bị QoS chặn download tốc độ cao file lớn (haiza)</p>
<p>Upload</p>
<p><img src="https://farm8.staticflickr.com/7470/15949950969_fbd629132e_o.png"></p>
<p>Mạng công ty bị QoS chặn upload tốc độ cao file lớn (haiza)</p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">Author：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Tuan Tran</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">Link to this article：</span><span class="p-copytight-value"><a href="/blog/2014/12/29/virtual-machine-in-azure-part-2-configure-to-login-with-microsoft-account-make-it-ftp-server/">https://huntertran.github.io/blog/2014/12/29/virtual-machine-in-azure-part-2-configure-to-login-with-microsoft-account-make-it-ftp-server/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">Copyright：</span><span class="p-copytight-value">All rights reserved with<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>agreement. Include the source <a href="https://huntertran.github.io/blog">Tuan Tran's blog</a>！</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tags"></i><a href="/blog/tags/file/">file</a><a href="/blog/tags/azure/">azure</a><a href="/blog/tags/virtual-machine/">virtual machine</a><a href="/blog/tags/ftp/">ftp</a></span></div><aside id="toc"><div class="toc-title">Table of Contents</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Login-with-MS-Account"><span class="toc-number">1.</span> <span class="toc-text">Login with MS Account</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FTP-Server"><span class="toc-number">2.</span> <span class="toc-text">FTP Server</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cai-dat-tren-Azure-Portal"><span class="toc-number">2.1.</span> <span class="toc-text">Cài đặt trên Azure Portal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cai-dat-tren-Virtual-Machine"><span class="toc-number">2.2.</span> <span class="toc-text">Cài đặt trên Virtual Machine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cai-FileZilla-Server"><span class="toc-number">2.2.1.</span> <span class="toc-text">Cài FileZilla Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thiep-lap-Firewall"><span class="toc-number">2.2.2.</span> <span class="toc-text">Thiếp lập Firewall</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cai-dat-tren-Local-Machine"><span class="toc-number">2.3.</span> <span class="toc-text"> Cài đặt trên Local Machine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cai-dat-FileZilla-Client"><span class="toc-number">2.3.1.</span> <span class="toc-text">Cài đặt FileZilla Client</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thu-nghiem-toc-do-cua-FTP-Server-moi-tao"><span class="toc-number">2.4.</span> <span class="toc-text">Thử nghiệm tốc độ của FTP Server mới tạo</span></a></li></ol></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/blog/2014/12/29/2014-in-review/">&lt; 2014 in review</a><a class="next" href="/blog/2014/12/03/virtual-machine-in-azure-part-1-create-virtual-machine-and-connect-to-it/">Virtual Machine in Azure Part 1: Create virtual machine and connect to it &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  lang: 'en',
  placeholder:'ヾﾉ≧∀≦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright © 2016 - 2020 <a href="/blog/." rel="nofollow">Tuan Tran's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/blog/plugins/prettify/prettify.js"></script><script type="text/javascript" src="/blog/js/search.js"></script><script type="text/javascript" src="/blog/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.1" async></script></body></html>