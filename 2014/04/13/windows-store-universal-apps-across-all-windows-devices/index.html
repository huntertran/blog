<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>[Windows Store] Universal Apps across all Windows devices | Tuan Tran's Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/blog/atom.xml" title="Tuan Tran's Blog" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/blog/plugins/prettify/doxy.css"><script type="text/javascript" src="/blog/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">Tuan Tran's Blog</a></h1></div><p class="m-desc">Share to be shared</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/blog/archives/">Archives</a></li><li><span class="dot">●</span><a href="/blog/categories/">Categories</a></li><li><span class="dot">●</span><a href="/blog/tags/">Tags</a></li><li><span class="dot">●</span><a href="/blog/about/">About</a></li><li><span class="dot">●</span><a href="/blog/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="Search for" onfocus="if(this.value=='Search for'){this.value='';}" onblur="if(this.value==''){this.value='Search for';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">[Windows Store] Universal Apps across all Windows devices</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/blog/2014/04/13/windows-store-universal-apps-across-all-windows-devices/">2014-04-13</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/blog/categories/C/">C#</a>&nbsp;&bull;&nbsp;<a href="/blog/categories/c/">c</a>&nbsp;&bull;&nbsp;<a href="/blog/categories/c/Windows-Phone/">Windows Phone</a>&nbsp;&bull;&nbsp;<a href="/blog/categories/c/Windows-Phone/Windows-Store-App/">Windows Store App</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><p>Ở hội nghị BUILD 2014, Microsoft đã nhắc tới Universal App, ứng dụng có thể chạy được trên cả Windows và Windows Phone</p>
<p>Và ngay bây giờ, từ bản cập nhật Update 2 RC của Visual Studio 2013, bạn đã có thể xây dựng một ứng dụng như thế</p>
<p><img src="http://farm8.staticflickr.com/7132/13789811995_025cfbd0bc_o.png"></p>
<a id="more"></a>

<h1 id="Cap-nhat-Visual-Studio-2013-len-Updat-2-RC"><a href="#Cap-nhat-Visual-Studio-2013-len-Updat-2-RC" class="headerlink" title="Cập nhật Visual Studio 2013 lên Updat 2 RC"></a>Cập nhật Visual Studio 2013 lên Updat 2 RC</h1><p>Ngày 13-04-2014: Link tải: <a target="_blank" rel="noopener" href="http://blogs.msdn.com/b/windowsazure/archive/2014/04/09/deep-dive-visual-studio-2013-update-2-rc-and-azure-sdk-2-3.aspx">http://blogs.msdn.com/b/windowsazure/archive/2014/04/09/deep-dive-visual-studio-2013-update-2-rc-and-azure-sdk-2-3.aspx</a></p>
<h1 id="Tao-Project-Universal"><a href="#Tao-Project-Universal" class="headerlink" title="Tạo Project Universal"></a>Tạo Project Universal</h1><p>Sau khi cài đặt xong, bạn sẽ có thêm một số tùy chọn mới trong Visual Studio</p>
<p><img src="http://farm8.staticflickr.com/7212/13789855595_5d445495c2_o.png"></p>
<p>Chọn New Project</p>
<p><img src="http://farm4.staticflickr.com/3808/13790231944_a53d45556f_o.png"></p>
<p>Chọn Visual C# &gt; Store Apps &gt; Universal Apps</p>
<p>Tạo project xong, bạn sẽ có một Solution như trong hình dưới</p>
<p><img src="http://farm8.staticflickr.com/7447/13789942533_67c31f57db_o.png"></p>
<p>Nhìn vào là ta cũng biết ngay, Project Windows 8.1 và project Windows Phone 8.1</p>
<p>Còn Project “Shared” sẽ chứa các file dùng chung, cụ thể là Model và View Model</p>
<p>Ta sẽ tạo một ứng dụng đọc tin RSS đơn giản nhé</p>
<h1 id="Xay-dung-Model-va-ViewModel"><a href="#Xay-dung-Model-va-ViewModel" class="headerlink" title="Xây dựng Model và ViewModel"></a>Xây dựng Model và ViewModel</h1><p>Tạo 2 thư mục mới tên là Model và ViewModel trong Project Shared</p>
<p><img src="http://farm8.staticflickr.com/7414/13790305334_ae2e50f650_o.png"></p>
<p>Giả sử ta lấy trang này làm nguồn tin: <a target="_blank" rel="noopener" href="http://nhipsongso.tuoitre.vn/RssFeeds.aspx?ChannelID=430">http://nhipsongso.tuoitre.vn/RssFeeds.aspx?ChannelID=430</a></p>
<p>Vậy Model sẽ bao gồm 1 title và 1 content</p>
<p>Ta tạo class News với 2 Properties là Title và Content, tương ứng với 2 biến là title và content</p>
<p><img src="http://farm8.staticflickr.com/7387/13790346144_0eda252f4e_o.png"></p>
<p>Tạo file class trong Folder “Model”</p>
<p><img src="http://farm8.staticflickr.com/7117/13790357494_ca7a9589b9_o.png"></p>
<p>Kết quả</p>
<p><img src="http://farm8.staticflickr.com/7261/13790057603_73d1eb4d5e_o.png"></p>
<p>Tạo 2 biến private, dùng Resharper generate code ra Property</p>
<p>À mà quên, bạn phải khai báo kế thừa từ Interface INotifyPropertyChanged</p>
<p><img src="http://farm4.staticflickr.com/3820/13790402894_fb134c2ecc_o.png"></p>
<p>Sau đó dùng Generate Code của Resharper</p>
<p><img src="http://farm3.staticflickr.com/2934/13790084775_4662772e1a_o.png"></p>
<p>Chọn Property</p>
<p><img src="http://farm8.staticflickr.com/7427/13790093875_eb1cc4a58d_o.png"></p>
<p>Chọn luôn như hình, bấm finish</p>
<p><img src="http://farm8.staticflickr.com/7437/13790126693_3277529e49_o.png"></p>
<p>Thế là xong Model</p>
<p>Tạo class NewsViewModel trong Folder ViewModel</p>
<p>Trong class đó, khai báo một ObservableCollection</p>
<p><img src="http://farm8.staticflickr.com/7440/13816583833_af8e4ff21f_o.png"></p>
<p>Tạo thêm một class StaticViewModels trong Folder ViewModel. File class này sẽ chứa các biến ViewModel dạng static mà ta sẽ sử dụng trong toàn App (Trước kia bạn thường khai báo chúng trực tiếp trong file App.xaml.cs, nay gom nó lại một nơi để dễ quản lý)</p>
<p><img src="http://farm4.staticflickr.com/3811/13816896774_7eda94c0fd_o.png"></p>
<p>Trong file này, khai báo một Intance của NewsViewModel</p>
<p><img src="http://farm8.staticflickr.com/7349/13817716275_cd906cb30a_o.png"></p>
<p>Tạo một thư mục Utilities, trong đó, tạo một class StaticMethod. Ta sẽ nhét code lấy HTML vào đây</p>
<p><img src="http://farm8.staticflickr.com/7066/13816648423_80664aab92_o.png"></p>
<p>Trong này, gõ lệnh như sau</p>
<p><img src="http://farm4.staticflickr.com/3718/13816652445_57b587715d_o.png"></p>
<p>Mở lại file NewsViewModel, tạo thêm method GetNewsAsyncTask</p>
<p><img src="http://farm8.staticflickr.com/7090/13818091324_6f9567c7ce_o.png"></p>
<p>Thư viện HtmlDocument lấy từ HtmlAgilityPack trong Nuget, bạn phải add nó vào trong References của Project Windows 8.1</p>
<p>Sau khi xong, mở file MainPage.xaml của Project Windows 8.1 lên, thêm vào đó một ListBox để hiển thị danh sách tin</p>
<p><img src="http://farm8.staticflickr.com/7396/13818053024_8a8f63e046_o.png"></p>
<p>Sau đó, mở file Code Behind và thêm những dòng sau:</p>
<p><img src="http://farm6.staticflickr.com/5095/13818062924_84818d20d1_o.png"></p>
<p>Chạy thử</p>
<p><img src="http://farm8.staticflickr.com/7371/13817751965_3b549082de_o.png"></p>
<h1 id="Xay-dung-Template"><a href="#Xay-dung-Template" class="headerlink" title="Xây dựng Template"></a>Xây dựng Template</h1><p>Mở file MainPage.xaml trong Project Windows 8.1</p>
<p>Click chuột phải vào ListBox &gt; Edit Additional Template &gt; Create Empty</p>
<p><img src="http://farm4.staticflickr.com/3794/13818117864_1bac953a3c_o.png"></p>
<p>Trong hộp thoại hiện ra, đặt tên nó là DataTemplate</p>
<p><img src="http://farm8.staticflickr.com/7308/13818173834_c9983506b6_o.png"></p>
<p>Edit lại thành như sau</p>
<p><img src="http://farm3.staticflickr.com/2903/13817868373_46fdd7e116_o.png"></p>
<p>Nhấn nút Local Machine để chạy thử</p>
<p><img src="http://farm3.staticflickr.com/2844/13817864265_226b8940eb_o.png"></p>
<p>Thật tuyệt phải không?</p>
<h1 id="Tao-tuong-tu-ben-Windows-Phone-8-1"><a href="#Tao-tuong-tu-ben-Windows-Phone-8-1" class="headerlink" title="Tạo tương tự bên Windows Phone 8.1"></a>Tạo tương tự bên Windows Phone 8.1</h1><p>Mở file MainPage.xaml của Project Windows Phone 8.1, copy và paste những thứ tương tự nhau</p>
<p><img src="http://farm8.staticflickr.com/7457/13818218074_cfcbe1015f_o.png"></p>
<p>Tiếp tục mở code behind, và làm tương tự</p>
<p><img src="http://farm4.staticflickr.com/3802/13818261174_95d475e43e_o.png"></p>
<p>Chọn lại Startup Project</p>
<p><img src="http://farm8.staticflickr.com/7433/13817947335_83e0d03ede_o.png"></p>
<p>Ôi không, lỗi xuất hiện :’(</p>
<p><img src="http://farm4.staticflickr.com/3809/13818652393_97c16b491e_o.png"></p>
<p>Khi bạn chọn Startup Project là Windows Phone, vì trong Reference của Windows Phone chưa có thư viện HtmlAgilityPack nên các tham chiếu tới thư viện này đều gặp lỗi</p>
<p>Ta add thêm thư viện này thông qua Nuget</p>
<p><img src="http://farm4.staticflickr.com/3732/13818649855_10b7a8e826_o.png"></p>
<p>Một lỗi xuất hiện</p>
<p><img src="http://farm4.staticflickr.com/3786/13818700683_7345a9aa07_o.png"></p>
<p>Nó phàn nàn là cái package này chả chứa file nào target tới Windows Phone 8.1 cả.</p>
<p>Vì dùng chung một bộ thư viện với Windows 8.1, Windows Phone 8.1 có khả năng add các DLL chỉ tương thích với Windows 8.1.</p>
<p>Chọn References &gt; Ad References…</p>
<p><img src="http://farm4.staticflickr.com/3793/13818743355_40d8d045a1_o.png"></p>
<p>Chọn mục Browse &gt; Nhấn nút Browse, tìm đến thư mục bin &gt; Debug của Windows 8.1 để add thư viện HtmlAgilityPack</p>
<p><img src="http://farm8.staticflickr.com/7361/13819126364_02dda6cce9_o.png"></p>
<p><img src="http://farm4.staticflickr.com/3763/13819120204_1aa2d2caff_o.png"></p>
<p>Và khi add xong, woala, mọi lỗi đã biến mất, code đã “green” trở lại</p>
<p>Lưu ý: Copy file Annotation.cs trong thư mục Property của Project Windows 8.1 và Paste nó vào bất kỳ chỗ nào trong Project Windows Phone (thực hiện việc Copy và Paste này trên Solution Explorer nhé). Nếu bạn có Resharper, bạn có thể để Resharper tự sinh lại file này bằng cách xóa các method OnPropertyChanged trong News Model, và để Resharper Implement lại nó</p>
<p>Chạy thử Project WP8.1</p>
<p><img src="http://farm3.staticflickr.com/2891/13818903143_7951e186c4_o.png"></p>
<p>Done, bạn đã tự tạo một UniversalApp rồi đấy</p>
<h1 id="XAML-va-CodeBehind-dung-chung"><a href="#XAML-va-CodeBehind-dung-chung" class="headerlink" title="XAML và CodeBehind dùng chung"></a>XAML và CodeBehind dùng chung</h1><p>Như bạn có thể thấy ở hình trên, XAML và CodeBehind ở cả 2 Project rất giống nhau, hầu như không thay đổi gì cả</p>
<p>Cách đây rất lâu, trong một buổi training tại văn phòng Microsoft, đã có người từng hỏi “tại sao không dùng chung XAML cho cả Windows 8 và Windows Phone?”. Câu trả lời khi đó là Windows 8 và Windows Phone có bộ thư viện hơi khác nhau, nên một số control cũng khác nhau. Bây giờ, Microsoft đã đem lại khả năng “dùng chung” đó</p>
<p>Tạo một Folder tên View trong Project Shared</p>
<p>Add New một BlankPage, đặt tên nó là MainPage</p>
<p><img src="http://farm8.staticflickr.com/7104/13819321114_2b92d23a10_o.png"></p>
<p>Copy và Paste code từ Project Windows Phone (cả XAML lẫn code Behind)</p>
<p>Ở trên cùng của XAML Editor, bạn sẽ thấy một Drop down list thú vị</p>
<p><img src="http://farm8.staticflickr.com/7269/13819008325_d5b627d827_o.png"></p>
<p>Ở đây, bạn có thể thay đổi kiểu View mà Code XAML này được compile, trong hình đang chọn Windows Phone</p>
<p>Hãy thử chuyển nó sang Windows, bạn sẽ thấy giao diện Visual Editor thay đổi</p>
<p>Mở file App.xaml.cs, kéo xuống dòng 98, chỉnh sửa thành View.MainPage</p>
<p><img src="http://farm4.staticflickr.com/3730/13819137865_97f6aea455_o.png"></p>
<p>Chỉnh Startup Project là Windows</p>
<p><img src="http://farm6.staticflickr.com/5006/13819151033_e8fe2f0c54_o.png"></p>
<p>Chạy thử</p>
<p><img src="http://farm3.staticflickr.com/2937/13819149935_bea2bb72da_o.png"></p>
<p>Chỉnh Startup Project thành Windows Phone, nhấn chạy thử</p>
<p><img src="http://farm3.staticflickr.com/2891/13818903143_7951e186c4_o.png"></p>
<p>Thế là xong, bạn đã có một Page hiển thị được ở cả 2 giao diện nhé.</p>
<p>Trong các bài Blog sau, mình hy vọng sẽ có giải thích rõ ràng hơn về các Control dùng chung và cách hiển thị của chúng trên giao diện. Dù sao thì đây mới chỉ là Release Candidate. Sẽ còn thay đổi nhiều trong tương lai.</p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">Author：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Tuan Tran</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">Link to this article：</span><span class="p-copytight-value"><a href="/blog/2014/04/13/windows-store-universal-apps-across-all-windows-devices/">https://huntertran.github.io/blog/2014/04/13/windows-store-universal-apps-across-all-windows-devices/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">Copyright：</span><span class="p-copytight-value">All rights reserved with<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>agreement. Include the source <a href="https://huntertran.github.io/blog">Tuan Tran's blog</a>！</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tags"></i><a href="/blog/tags/windows-phone/">windows phone</a><a href="/blog/tags/windows-store/">windows store</a><a href="/blog/tags/universal/">universal</a></span></div><aside id="toc"><div class="toc-title">Table of Contents</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cap-nhat-Visual-Studio-2013-len-Updat-2-RC"><span class="toc-number">1.</span> <span class="toc-text">Cập nhật Visual Studio 2013 lên Updat 2 RC</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Tao-Project-Universal"><span class="toc-number">2.</span> <span class="toc-text">Tạo Project Universal</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Xay-dung-Model-va-ViewModel"><span class="toc-number">3.</span> <span class="toc-text">Xây dựng Model và ViewModel</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Xay-dung-Template"><span class="toc-number">4.</span> <span class="toc-text">Xây dựng Template</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Tao-tuong-tu-ben-Windows-Phone-8-1"><span class="toc-number">5.</span> <span class="toc-text">Tạo tương tự bên Windows Phone 8.1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XAML-va-CodeBehind-dung-chung"><span class="toc-number">6.</span> <span class="toc-text">XAML và CodeBehind dùng chung</span></a></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/blog/2014/05/02/basic-for-absolute-beginner-part-6-source-control/">&lt; [Basic for Absolute Beginner] – [Part 6] – Source Control</a><a class="next" href="/blog/2014/04/04/basic-for-absolute-beginner-part-5-analytics-for-your-apps/">[Basic for Absolute Beginner] – [Part 5] – Analytics for your apps &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  lang: 'en',
  placeholder:'ヾﾉ≧∀≦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright © 2016 - 2020 <a href="/blog/." rel="nofollow">Tuan Tran's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/blog/plugins/prettify/prettify.js"></script><script type="text/javascript" src="/blog/js/search.js"></script><script type="text/javascript" src="/blog/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.1" async></script></body></html>