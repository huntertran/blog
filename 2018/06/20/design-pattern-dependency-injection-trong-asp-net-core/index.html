<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/theme/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/theme/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/theme/favicon-16x16.png">
  <link rel="mask-icon" href="/images/theme/avatar.png" color="#222">
  <meta name="msvalidate.01" content="1CB8DB019C58E7852A318AAB16B1ABE5">
  <meta name="yandex-verification" content="92d8d8e521a054f7">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"huntertran.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":true,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Dependency Injection là một kỹ thuật vô cùng thông dụng để nới lỏng các objects và class phụ thuộc vào chúng. Nghe khó hiểu quá phải ko các bạn? Bài viết này sẽ mô tả kỹ thuật này, cho bạn một cái nhì">
<meta property="og:type" content="article">
<meta property="og:title" content="[Design Pattern] - Dependency Injection trong ASP.NET Core">
<meta property="og:url" content="https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/">
<meta property="og:site_name" content="Hunter Tran&#39;s Blog">
<meta property="og:description" content="Dependency Injection là một kỹ thuật vô cùng thông dụng để nới lỏng các objects và class phụ thuộc vào chúng. Nghe khó hiểu quá phải ko các bạn? Bài viết này sẽ mô tả kỹ thuật này, cho bạn một cái nhì">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/1750/42864104992_c6bcdb3276_o.png">
<meta property="og:image" content="https://huntertran.github.io/images/flickr/1753/42012713695_56fcb2b4a5_o.jpg">
<meta property="article:published_time" content="2018-06-20T12:30:55.000Z">
<meta property="article:modified_time" content="2024-03-03T19:04:36.705Z">
<meta property="article:author" content="Hunter Tran">
<meta property="article:tag" content="ASP.NET">
<meta property="article:tag" content="dependency injection">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huntertran.github.io/images/flickr/1750/42864104992_c6bcdb3276_o.png">


<link rel="canonical" href="https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/","path":"2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/","title":"[Design Pattern] - Dependency Injection trong ASP.NET Core"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[Design Pattern] - Dependency Injection trong ASP.NET Core | Hunter Tran's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174401878-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-174401878-1","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Hunter Tran's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hunter Tran's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Share to be shared</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-power-bi-reports"><a href="/power-bi-reports/" rel="section"><i class="fa fa-chart-simple fa-fw"></i>Power BI Reports</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Van-de"><span class="nav-text">1. Vấn đề</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Loi-ich"><span class="nav-text">2. Lợi ích</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Back-to-code"><span class="nav-text">3. Back to code</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Interface"><span class="nav-text">3.1. Interface</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Implementation"><span class="nav-text">3.2. Implementation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Register"><span class="nav-text">4. Register</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-Lifetime"><span class="nav-text">4.1. Lifetime</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Contructor-Injection"><span class="nav-text">4.2. Contructor Injection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-Action-Injection"><span class="nav-text">4.3. Action Injection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-Service-trong-Service"><span class="nav-text">4.4. Service trong Service</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hunter Tran"
      src="/images/theme/avatar.png">
  <p class="site-author-name" itemprop="name">Hunter Tran</p>
  <div class="site-description" itemprop="description">Programming, technologies, computer tips and life thoughts</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">127</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">229</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/huntertran" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;huntertran" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/huntertrantuan" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;huntertrantuan" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/4506315/tuan-tran" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;4506315&#x2F;tuan-tran" rel="noopener me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/theme/avatar.png">
      <meta itemprop="name" content="Hunter Tran">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hunter Tran's Blog">
      <meta itemprop="description" content="Programming, technologies, computer tips and life thoughts">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[Design Pattern] - Dependency Injection trong ASP.NET Core | Hunter Tran's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Design Pattern] - Dependency Injection trong ASP.NET Core<a href="https://github.com/huntertran/blog/edit/master/source/_posts/20180620-design-pattern-dependency-injection-trong-asp-net-core.md" class="post-edit-link" title="Edit this post" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-06-20 08:30:55" itemprop="dateCreated datePublished" datetime="2018-06-20T08:30:55-04:00">2018-06-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-03 14:04:36" itemprop="dateModified" datetime="2024-03-03T14:04:36-05:00">2024-03-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Design-Pattern/" itemprop="url" rel="index"><span itemprop="name">Design Pattern</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Dependency Injection là một kỹ thuật vô cùng thông dụng để <em>nới lỏng</em> các objects và class phụ thuộc vào chúng. Nghe khó hiểu quá phải ko các bạn?</p>
<p>Bài viết này sẽ mô tả kỹ thuật này, cho bạn một cái nhìn tổng quan (hy vọng là khách quan) về DI</p>
<span id="more"></span>
<ul>
<li><a href="#1-v%E1%BA%A5n-%C4%91%E1%BB%81">1. Vấn đề</a></li>
<li><a href="#2-l%E1%BB%A3i-%C3%ADch">2. Lợi ích</a></li>
<li><a href="#3-back-to-code">3. Back to code</a><ul>
<li><a href="#31-interface">3.1. Interface</a></li>
<li><a href="#32-implementation">3.2. Implementation</a></li>
</ul>
</li>
<li><a href="#4-register">4. Register</a><ul>
<li><a href="#41-lifetime">4.1. Lifetime</a></li>
<li><a href="#42-contructor-injection">4.2. Contructor Injection</a></li>
<li><a href="#43-action-injection">4.3. Action Injection</a></li>
<li><a href="#44-service-trong-service">4.4. Service trong Service</a></li>
</ul>
</li>
</ul>
<h1 id="1-Van-de"><a href="#1-Van-de" class="headerlink" title="1. Vấn đề"></a>1. Vấn đề</h1><p>Hãy tưởng tượng bạn muốn uống coca, nhà ko còn chai coca nào Bạn phải ra Circle K, đi lòng vòng trong cửa hàng để kiếm 1 chai coca, trả tiền, đi về</p>
<ul>
<li>Bạn có thể quên ko trả tiền</li>
<li>Bạn có thể ko tìm thấy Circle K nào gần cả</li>
<li>Bạn có thể ko tìm thấy chai coca nào trong circle k cả</li>
<li>Bạn có thể lấy nhầm 1 chai xá xị chương dương thay vì coca</li>
</ul>
<p>Với Dependency Injection, mọi việc sẽ khác đi</p>
<p>Bạn đưa tiền cho 1 thằng nhóc có nhiệm vụ chuyên đi mua nước ngọt cho khu xóm 5 phút sau, nó xuất hiện với chai coca của bạn</p>
<p>Một người khác trong cùng khu xóm cũng có nhu cần gần giống bạn, nhưng họ muốn uống pepsi</p>
<p>Thay vì cũng phải đi ra cửa hàng và tự mua pepsi và gặp các vấn đề như bạn gặp, họ cũng gọi thằng nhóc đó lại, và 5 phút sau, chai pepsi ướp lạnh ở trong tay họ. Thằng nhóc đó chính là 1 <strong><em>Service</em></strong>, và bạn phụ thuộc vô thằng nhóc đó để có nước ngọt uống</p>
<h1 id="2-Loi-ich"><a href="#2-Loi-ich" class="headerlink" title="2. Lợi ích"></a>2. Lợi ích</h1><p>Quay trở lại với ví dụ trên, lợi ích của bạn khi dùng <strong><em>Service</em></strong> mua nước ngọt của thằng nhóc là gì?</p>
<ul>
<li>Bạn ko cần quan tâm thằng nhóc đó nó làm gì để có nước ngọt cho bạn</li>
<li>Bạn có thể yêu cầu nhiều loại nước ngọt khác nhau mà ko cần biết hình dạng hay chỗ bán</li>
</ul>
<h1 id="3-Back-to-code"><a href="#3-Back-to-code" class="headerlink" title="3. Back to code"></a>3. Back to code</h1><p>Quay trở lại với code, bạn sẽ implement DI như thế nào?</p>
<h2 id="3-1-Interface"><a href="#3-1-Interface" class="headerlink" title="3.1. Interface"></a>3.1. Interface</h2><pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDrinkBuyer</span> &#123; <span class="function"><span class="keyword">void</span> <span class="title">BuyDrink</span>(<span class="params"><span class="built_in">string</span> name</span>)</span>; &#125;</code></pre>

<p>Khi thằng nhóc mua nước ngọt ở bên trên đã già, nó sẽ muốn truyền lại nhiệm vụ mua nước ngọt cho 1 thằng nhóc khác, và cứ thể. Mọi thằng nhóc mua nước ngọt trong xóm đều sẽ có 1 phương thức cơ bản là <code>BuyDrink</code> chấp nhận 1 param là tên của loại nước cần mua Bạn đóng vai trò là <code>WebApplication</code>, sẽ gọi phương thức này để có nước ngọt uống</p>
<h2 id="3-2-Implementation"><a href="#3-2-Implementation" class="headerlink" title="3.2. Implementation"></a>3.2. Implementation</h2><p>Người quản lý của mấy thằng nhóc mua nước ngọt này sẽ phân nhiệm vụ cho từng thằng nhóc 1</p>
<ul>
<li>Nhóc A mua ở Circle K</li>
<li>Nhóc B mua ở Vinmart</li>
</ul>
<p>Và họ sẽ implement như sau </p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CircleKDrinkBuyer</span>: <span class="title">IDrinkBuyer</span> 
&#123;
  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BuyDrink</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> 
  &#123;
    <span class="comment">// Go to circle k </span>
    <span class="comment">// Find the -name- drink </span>
    <span class="comment">// Buy it and deliver </span>
  &#125;
&#125;

<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">VinmartDrinkBuyer</span>: <span class="title">IDrinkBuyer</span> 
&#123;
  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BuyDrink</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> 
  &#123;
    <span class="comment">// Go to Vinmart </span>
    <span class="comment">// Find the -name- drink </span>
    <span class="comment">// Buy it and deliver </span>
  &#125;
&#125;</code></pre>

<p>Thế là xong Khi nhà bạn gần Vinmart, người quản lý sẽ cử thằng nhóc B - VinmartDrinkBuyer canh trước cổng nhà bạn. Bất kể khi nào bạn có nhu cầu mua nước ngọt, bạn sẽ gọi nó. Bạn đâu có biết là thằng nhóc B đó nó chỉ biết mua nước ngọt ở Vinmart thôi. Bạn chỉ quan tâm là bạn gọi nó, và bạn có nước ngọt uống</p>
<h1 id="4-Register"><a href="#4-Register" class="headerlink" title="4. Register"></a>4. Register</h1><p>Như vậy, khai báo như thế nào trong ứng dụng của bạn? khi tạo mới một ứng dụng asp.net core 2, đã có sẵn 1 số phương thức giúp bạn bắt đầu ngay và luôn</p>
<p><img src="/images/flickr/1750/42864104992_c6bcdb3276_o.png" alt="method in startup.cs"></p>
<p>bằng cách thêm vào dòng code sau <code>services.AddScoped();</code> bạn đã khai báo cho tất cả các class có dùng phương thức <code>BuyDrink</code> sẽ mua nước ngọt ở CircleK</p>
<h2 id="4-1-Lifetime"><a href="#4-1-Lifetime" class="headerlink" title="4.1. Lifetime"></a>4.1. Lifetime</h2><p><code>AddScoped</code> dùng để chỉ định <em>thời gian sống</em> của service này, có 3 loại:</p>
<ul>
<li>Transient: mỗi lần gọi tới nó sẽ là 1 biến thể mới hoàn toàn. Cái này chỉ phù hợp cho các loại service siu nhẹ nhàng và ko có lưu trữ trạng thái</li>
<li>Scoped: Trong cùng 1 request, nó sẽ chỉ được tạo 1 lần duy nhất</li>
<li>Singleton: Nó sẽ được tạo lần đầu tiên khi được gọi, và sẽ sống quài cho tới khi app bạn chết</li>
</ul>
<h2 id="4-2-Contructor-Injection"><a href="#4-2-Contructor-Injection" class="headerlink" title="4.2. Contructor Injection"></a>4.2. Contructor Injection</h2><p>Sau khi đã register service của bạn với 1 lifetime phù hợp, việc tiếp theo chính là <em>tiêm - inject</em> nó vào chỗ cần dùng (thường sẽ là controller) ASP.NET Core 2 hỗ trợ bạn inject service vào controller thông qua contructor của controller đó</p>
<p><img src="/images/flickr/1753/42012713695_56fcb2b4a5_o.jpg" alt="inject to controller"></p>
<h2 id="4-3-Action-Injection"><a href="#4-3-Action-Injection" class="headerlink" title="4.3. Action Injection"></a>4.3. Action Injection</h2><p>Đôi khi bạn chỉ cần cái service này trong 1 action cụ thể nào đó của controller thôi, thì sẽ có cách hơi khác </p>
<pre><code class="highlight csharp"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">About</span>(<span class="params">[FromServices] IDrinkBuyer drinkBuyer</span>)</span> 
&#123;
  drinkBuyer.BuyDrink(<span class="string">&quot;coca&quot;</span>);
  <span class="keyword">return</span> View();
&#125;</code></pre>

<h2 id="4-4-Service-trong-Service"><a href="#4-4-Service-trong-Service" class="headerlink" title="4.4. Service trong Service"></a>4.4. Service trong Service</h2><p>Nested services, service con, vân vân và mây mây</p>
<p>Đôi khi bạn cần phải có 1 service con để service cha chạy được, thì inject như nào</p>
<p>Rất đơn giản, cũng dùng contructor injection thôi</p>
<p>Giả sử Service <code>DrinkBuyer</code> cần có service <code>Trasport</code> để chạy </p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ITransport</span>
&#123;
  <span class="function"><span class="keyword">void</span> <span class="title">Transport</span>()</span>;
&#125;
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BikeTransport</span>: <span class="title">ITransport</span>
&#123;
  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Transport</span>()</span> 
  &#123;
    <span class="comment">// transport by bike </span>
  &#125;
&#125;

<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CarTransport</span>: <span class="title">ITransport</span>
&#123;
  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Transport</span>()</span>
  &#123;
    <span class="comment">// transport by car</span>
  &#125;
&#125;</code></pre>

<p>đầu tiên đăng ký nó trong <code>Startup.cs</code> <code>services.AddScoped();</code></p>
<p>sau đó bạn inject nó vào <code>DrinkBuyer</code> như sau</p>
<pre><code class="highlight csharp"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CircleKDrinkBuyer</span>: <span class="title">IDrinkBuyer</span> 
&#123;
  <span class="keyword">private</span> <span class="keyword">readonly</span> ITransport _transport;
  
  <span class="function"><span class="keyword">public</span> <span class="title">CircleKDrinkBuyer</span>(<span class="params">ITransport transport</span>)</span> 
  &#123;
      _transport = transport;
  &#125;
  
  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BuyDrink</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> &#123;
    <span class="comment">// Go to circle k </span>
    <span class="comment">// Find the -name- drink </span>
    <span class="comment">// Buy it </span>
    <span class="comment">// Deliver </span>
    _transport.Transport();
  &#125;
&#125;</code></pre>

<p>thế nà xong :D</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/theme/paypal.png" alt="Hunter Tran PayPal">
        <span>PayPal</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Hunter Tran
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/" title="[Design Pattern] - Dependency Injection trong ASP.NET Core">https://huntertran.github.io/blog/2018/06/20/design-pattern-dependency-injection-trong-asp-net-core/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/huntertrantuan">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/ASP-NET/" rel="tag"># ASP.NET</a>
              <a href="/tags/dependency-injection/" rel="tag"># dependency injection</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/06/12/aspnet-core-2-middleware/" rel="prev" title="[ASPNET Core 2] – Middleware">
                  <i class="fa fa-angle-left"></i> [ASPNET Core 2] – Middleware
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/07/10/repository-va-unit-of-work-pattern/" rel="next" title="Repository và Unit of Work Pattern">
                  Repository và Unit of Work Pattern <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-disqus">disqus</a></li>
            <li class="tab"><a href="#comment-utterances">utterances</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane disqus" id="comment-disqus">
              
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
            </div>
            <div class="tab-pane utterances" id="comment-utterances">
              <div class="comments utterances-container"></div>
            </div>
        </div>
      </div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2011 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Hunter Tran</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" integrity="sha256-4mJNT2bMXxcc1GCJaxBmMPdmah5ji0Ldnd79DKd1hoM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha256-9cmf7tcLdXpKsPi/2AWE93PbZpTp4M4tqzFk+lWomjU=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"huntertran-blog","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"huntertran/huntertran-blog-comments","issue_term":"pathname","theme":"github-dark"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
