<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>[ASP.NET Core 2.0] Custom Tag Helper | Tuan Tran's Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/blog/atom.xml" title="Tuan Tran's Blog" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/blog/plugins/prettify/doxy.css"><script type="text/javascript" src="/blog/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">Tuan Tran's Blog</a></h1></div><p class="m-desc">Share to be shared</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/blog/archives/">Archives</a></li><li><span class="dot">●</span><a href="/blog/categories/">Categories</a></li><li><span class="dot">●</span><a href="/blog/tags/">Tags</a></li><li><span class="dot">●</span><a href="/blog/about/">About</a></li><li><span class="dot">●</span><a href="/blog/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="Search for" onfocus="if(this.value=='Search for'){this.value='';}" onblur="if(this.value==''){this.value='Search for';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">[ASP.NET Core 2.0] Custom Tag Helper</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/blog/2018/01/12/asp-net-core-2-0-custom-tag-helper/">2018-01-12</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/blog/categories/C/">C#</a>&nbsp;&bull;&nbsp;<a href="/blog/categories/c/">c</a>&nbsp;&bull;&nbsp;<a href="/blog/categories/c/ASP-NET/">ASP.NET</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><p>ASP.NET Core giới thiệu một cách vô cùng tự nhiên để xây dựng các thẻ <code>input</code>, <code>label</code> và một số thẻ khác với từ khóa <code>asp-for</code>, chúng được gọi là <em><code>tag helper</code></em></p>
<p>Bạn cũng có thể tạo ra các <code>tag helper</code> của riêng mình để render ra các tag mong muốn</p>
<a id="more"></a>
<ul>
<li><p><a href="#m%E1%BB%99t-s%E1%BB%91-tag-helper">Một số tag helper</a></p>
</li>
<li><p><a href="#v%E1%BA%A5n-%C4%91%E1%BB%81-v%E1%BB%9Bi-label-tag-helper">Vấn đề với label tag helper</a></p>
</li>
<li><p><a href="#customize-label-tag-helper">Customize Label tag helper</a></p>
<ul>
<li><a href="#code">Code</a></li>
<li><a href="#khai-b%C3%A1o">Khai báo</a></li>
</ul>
</li>
<li><p><a href="#s%E1%BB%AD-d%E1%BB%A5ng">Sử dụng</a></p>
</li>
</ul>
<h1 id="Mot-so-tag-helper"><a href="#Mot-so-tag-helper" class="headerlink" title="Một số tag helper"></a>Một số tag helper</h1><p>ASP.NET MVC5</p>
<p>ASP.NET Core</p>
<p><code>@Html.TextBoxFor()</code></p>
<p>[code] <input asp-for=""/> [/code]</p>
<p><code>@Html.DropDownListFor()</code></p>
<p>[code] <select asp-for="" asp-items=""/> [/code]</p>
<p><code>@Html.LabelFor()</code></p>
<p>[code] <label asp-for=""></label> [/code]</p>
<p><code>@Html.ValidationMessageFor()</code></p>
<p>[code] <anytag asp-validation-for=""></anytag> [/code]</p>
<h1 id="Van-de-voi-label-tag-helper"><a href="#Van-de-voi-label-tag-helper" class="headerlink" title="Vấn đề với label tag helper"></a>Vấn đề với label tag helper</h1><p><code>label</code> là cái tag mà bạn sẽ customize hơi nhiều trong ứng dụng asp.net core của mình. Lý do là vì bạn muốn nó có thêm một dấu <code>*</code> màu đỏ đối với các input yêu cầu bắt buộc, bạn cũng muốn nó có thêm <code>(500 ký tự)</code> khi ô input chỉ cho phép nhập 500 ký tự.</p>
<p>Tất nhiên, tất cả những cái đó đều có thể thêm vào dễ dàng bằng cách … add tay</p>
<p>ASP.NET MVC, và sau này là ASP.NET CORE, cho phép bạn xây dựng <code>model</code> với các <code>DataAnnotation</code> nhằm khai báo cho cơ sở dữ liệu biết các giới hạn hoặc định nghĩa của một column trên database, đồng thời giúp bạn validate input field của nó ở client-side code</p>
<p>[code lang=csharp] [Required] [Display(Name = “User name”)] [StringLenght(15)] public string Username { get; set; } [/code]</p>
<p>Tuy nhiên, khi tạo input field cho property <code>username</code> này, bạn vẫn phải tự tạo tay các dấu <code>*</code> và dòng chữ <code>tối đa 15 ký tự</code> kia</p>
<p>[code lang=html] <label asp-for="Username"></label> <input asp-for="Username"/> <span asp-validation-for="Username"></span> [/code]</p>
<p>đoạn code trên sẽ generate ra các dòng html sau</p>
<p>[code lang=html] <label for="Username">User name</label> ….các dòng khác… [/code]</p>
<h1 id="Customize-Label-tag-helper"><a href="#Customize-Label-tag-helper" class="headerlink" title="Customize Label tag helper"></a>Customize Label tag helper</h1><p>Chúng ta sẽ tạo ra một custom tag helper với tên là <code>requiredlabel</code></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>[code lang=csharp] namespace YourNamespace.Extensions.TagHelpers { using System; using System.IO; using System.Text.Encodings.Web; using Microsoft.AspNetCore.Mvc.Rendering; using Microsoft.AspNetCore.Mvc.TagHelpers; using Microsoft.AspNetCore.Mvc.ViewFeatures; using Microsoft.AspNetCore.Razor.TagHelpers;</p>
<p>// Source code for label tag helper: Mvc/src/Microsoft.AspNetCore.Mvc.TagHelpers/LabelTagHelper.cs // <a target="_blank" rel="noopener" href="https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers/LabelTagHelper.cs">https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers/LabelTagHelper.cs</a></p>
<p>[HtmlTargetElement(“requiredlabel”, Attributes = ForAttributeName)] public class RequiredLabelTagHelper : TagHelper { private const string ForAttributeName = “asp-for”;</p>
<p>// Will be used as highlight-class in html public string HighlightClass { get; set; }</p>
<p>/// <summary> /// Creates a new <see cref="LabelTagHelper"/>. /// </summary> /// <param name="generator">The <see cref="IHtmlGenerator"/>.</param> public RequiredLabelTagHelper(IHtmlGenerator generator) { Generator = generator; }</p>
<p>/// <inheritdoc /> public override int Order =&gt; -1000;</p>
<p>[HtmlAttributeNotBound] [ViewContext] public ViewContext ViewContext { get; set; }</p>
<p>protected IHtmlGenerator Generator { get; }</p>
<p>/// <summary> /// An expression to be evaluated against the current model. /// </summary> [HtmlAttributeName(ForAttributeName)] public ModelExpression For { get; set; }</p>
<p>/// <inheritdoc /> /// <remarks>Does nothing if <see cref="For"/> is <c>null</c>.</remarks> public override void Process(TagHelperContext context, TagHelperOutput output) { if (context == null) { throw new ArgumentNullException(nameof(context)); }</p>
<p>if (output == null) { throw new ArgumentNullException(nameof(output)); }</p>
<p>var requiredMarkTagBuilder = new TagBuilder(“span”); requiredMarkTagBuilder.AddCssClass(HighlightClass); requiredMarkTagBuilder.InnerHtml.Append(“ *“);</p>
<p>var tagBuilder = Generator.GenerateLabel( ViewContext, For.ModelExplorer, For.Name, labelText: null, htmlAttributes: null);</p>
<p>if (For.ModelExplorer.Metadata.IsRequired) { using (var writer = new StringWriter()) { requiredMarkTagBuilder.WriteTo(writer, HtmlEncoder.Default); tagBuilder.InnerHtml.AppendHtml(writer.ToString()); } }</p>
<p>output.TagName = tagBuilder.TagName; output.MergeAttributes(tagBuilder); output.Content.SetHtmlContent(tagBuilder.InnerHtml); } } } [/code]</p>
<h2 id="Khai-bao"><a href="#Khai-bao" class="headerlink" title="Khai báo"></a>Khai báo</h2><p>Mở <code>View/_ViewImports.cshtml</code></p>
<p>[code lang=csharp] @addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers</p>
<p>@* Thêm dòng sau *@ @addTagHelper *, YourNamespace.Extensions [/code]</p>
<blockquote>
<p>Đoạn code này giúp tag helper của bạn có thể hoạt động trong các view razor. Với tên namespace khác, bạn cần phải thay đổi đoạn code đó tương ứng Xem thêm tại: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro">https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro</a> mục <em>Managing Tag Helper scope</em></p>
</blockquote>
<h1 id="Su-dung"><a href="#Su-dung" class="headerlink" title="Sử dụng"></a>Sử dụng</h1><p>Vô cùng đơn giản</p>
<p>[code lang=html] <requiredlabel asp-for="Username" highlight-class="red bold"></requiredlabel> [/code]</p>
<p>sẽ render ra đoạn code html sau</p>
<p>[code lang=html] <label for="Username">User name<span class="red bold"> *</span></label> [/code]</p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">Author：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Tuan Tran</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">Link to this article：</span><span class="p-copytight-value"><a href="/blog/2018/01/12/asp-net-core-2-0-custom-tag-helper/">https://huntertran.github.io/blog/2018/01/12/asp-net-core-2-0-custom-tag-helper/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">Copyright：</span><span class="p-copytight-value">All rights reserved with<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>agreement. Include the source <a href="https://huntertran.github.io/blog">Tuan Tran's blog</a>！</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tags"></i><a href="/blog/tags/input/">input</a><a href="/blog/tags/net-core/">.net core</a><a href="/blog/tags/label/">label</a><a href="/blog/tags/tag-helper/">tag helper</a></span></div><aside id="toc"><div class="toc-title">Table of Contents</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mot-so-tag-helper"><span class="toc-number">1.</span> <span class="toc-text">Một số tag helper</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Van-de-voi-label-tag-helper"><span class="toc-number">2.</span> <span class="toc-text">Vấn đề với label tag helper</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Customize-Label-tag-helper"><span class="toc-number">3.</span> <span class="toc-text">Customize Label tag helper</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Code"><span class="toc-number">3.1.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Khai-bao"><span class="toc-number">3.2.</span> <span class="toc-text">Khai báo</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Su-dung"><span class="toc-number">4.</span> <span class="toc-text">Sử dụng</span></a></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/blog/2018/01/14/asp-net-mvc-error-message-chung-ma-rieng/">&lt; [asp.net mvc] Error Message - chung mà riêng</a><a class="next" href="/blog/2017/12/10/asp-net-core-2-0-dung-vscode-va-target-net-framework/">[ASP.NET Core 2.0] - dùng VSCode và target .NET Framework &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'',
  appKey:'',
  lang: 'en',
  placeholder:'ヾﾉ≧∀≦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright © 2016 - 2020 <a href="/blog/." rel="nofollow">Tuan Tran's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/blog/plugins/prettify/prettify.js"></script><script type="text/javascript" src="/blog/js/search.js"></script><script type="text/javascript" src="/blog/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.1" async></script></body></html>